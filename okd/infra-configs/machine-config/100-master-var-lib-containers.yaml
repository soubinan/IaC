# Generated by Butane; do not edit
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: master
  name: 100-master-var-lib-containers
spec:
  config:
    ignition:
      version: 3.4.0
    storage:
      files:
        - path: /etc/create-filesystem
          mode: 0755
          contents:
            # Created from the base64 encoded version of the script var-lib-containers.sh
            source: data:application/x-shellscript;base64,IyEvYmluL2Jhc2gKCm1rZnMueGZzIC1MIHZhci1saWItY29udCAtZiAvZGV2L2Rpc2svYnktaWQvc2NzaS1TREVMTF9QRVJDX0gzMzBfQWRwXzAwNDI1ZTE2YTQ5ZTM4OTIyZjAwODZmNTU3ZjA5OGNkIHx8IGVjaG8gIlVuYWJsZSB0byBjcmVhdGUgZmlsZXN5c3RlbSwgcHJvYmFibHkgYWxyZWFkeSBleGlzdHMiCnVkZXZhZG0gc2V0dGxlCnRvdWNoIC9ldGMvdmFyLWxpYi1jb250YWluZXJzLW1vdW50CmV4aXQK
    systemd:
      units:
        - contents: |
            [Unit]
            Description=Create filesystem for /var/lib/containers
            DefaultDependencies=false
            After=systemd-udev-settle.service
            Before=local-fs-pre.target
            ConditionPathExists=!/etc/var-lib-containers-mount

            [Service]
            RemainAfterExit=yes
            ExecStart=/etc/create-filesystem

            RestartForceExitStatus=77

            [Install]
            WantedBy=multi-user.target
          enabled: true
          name: create-var-lib-containers.service
        - contents: |
            [Unit]
            Description=Mount /var/lib/containers
            Before=local-fs.target

            [Mount]
            What=/dev/disk/by-label/var-lib-cont
            Where=/var/lib/containers
            Type=xfs
            TimeoutSec=120s

            [Install]
            RequiredBy=local-fs.target
          enabled: true
          name: var-lib-containers.mount
        - contents: |
            [Unit]
            Description=Restore recursive SELinux security contexts
            DefaultDependencies=no
            After=var-lib-containers.mount
            Before=crio.service

            [Service]
            Type=oneshot
            RemainAfterExit=yes
            ExecStart=/sbin/restorecon -R /var/lib/containers/
            TimeoutSec=0

            [Install]
            WantedBy=multi-user.target graphical.target
          enabled: true
          name: restorecon-var-lib-containers.service
